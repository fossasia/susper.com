{"version":3,"file":"system_js_ng_module_factory_loader.js","sourceRoot":"","sources":["../../../../../modules/@angular/core/src/linker/system_js_ng_module_factory_loader.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\n\nimport {Injectable, Optional} from '../di';\n\nimport {Compiler} from './compiler';\nimport {NgModuleFactory} from './ng_module_factory';\nimport {NgModuleFactoryLoader} from './ng_module_factory_loader';\n\nconst /** @type {?} */ _SEPARATOR = '#';\n\nconst /** @type {?} */ FACTORY_CLASS_SUFFIX = 'NgFactory';\n/**\n *  Configuration for SystemJsNgModuleLoader.\n  * token.\n  * *\n * @abstract\n */\nexport abstract class SystemJsNgModuleLoaderConfig {\n  /**\n   * Prefix to add when computing the name of the factory module for a given module name.\n   */\n  factoryPathPrefix: string;\n\n  /**\n   * Suffix to add when computing the name of the factory module for a given module name.\n   */\n  factoryPathSuffix: string;\n}\n\nfunction SystemJsNgModuleLoaderConfig_tsickle_Closure_declarations() {\n /**\n  * Prefix to add when computing the name of the factory module for a given module name.\n  * @type {?}\n  */\nSystemJsNgModuleLoaderConfig.prototype.factoryPathPrefix;\n /**\n  * Suffix to add when computing the name of the factory module for a given module name.\n  * @type {?}\n  */\nSystemJsNgModuleLoaderConfig.prototype.factoryPathSuffix;\n}\n\n\nconst /** @type {?} */ DEFAULT_CONFIG: SystemJsNgModuleLoaderConfig = {\n  factoryPathPrefix: '',\n  factoryPathSuffix: '.ngfactory',\n};\n/**\n *  NgModuleFactoryLoader that uses SystemJS to load NgModuleFactory\n */\nexport class SystemJsNgModuleLoader implements NgModuleFactoryLoader {\nprivate _config: SystemJsNgModuleLoaderConfig;\n/**\n * @param {?} _compiler\n * @param {?=} config\n */\nconstructor(private _compiler: Compiler,  config?: SystemJsNgModuleLoaderConfig) {\n    this._config = config || DEFAULT_CONFIG;\n  }\n/**\n * @param {?} path\n * @return {?}\n */\nload(path: string): Promise<NgModuleFactory<any>> {\n    const /** @type {?} */ offlineMode = this._compiler instanceof Compiler;\n    return offlineMode ? this.loadFactory(path) : this.loadAndCompile(path);\n  }\n/**\n * @param {?} path\n * @return {?}\n */\nprivate loadAndCompile(path: string): Promise<NgModuleFactory<any>> {\n    let [module, exportName] = path.split(_SEPARATOR);\n    if (exportName === undefined) {\n      exportName = 'default';\n    }\n\n    return System.import(module)\n        .then((module: any) => module[exportName])\n        .then((type: any) => checkNotEmpty(type, module, exportName))\n        .then((type: any) => this._compiler.compileModuleAsync(type));\n  }\n/**\n * @param {?} path\n * @return {?}\n */\nprivate loadFactory(path: string): Promise<NgModuleFactory<any>> {\n    let [module, exportName] = path.split(_SEPARATOR);\n    let /** @type {?} */ factoryClassSuffix = FACTORY_CLASS_SUFFIX;\n    if (exportName === undefined) {\n      exportName = 'default';\n      factoryClassSuffix = '';\n    }\n\n    return System.import(this._config.factoryPathPrefix + module + this._config.factoryPathSuffix)\n        .then((module: any) => module[exportName + factoryClassSuffix])\n        .then((factory: any) => checkNotEmpty(factory, module, exportName));\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: Compiler, },\n{type: SystemJsNgModuleLoaderConfig, decorators: [{ type: Optional }, ]},\n];\n}\n\nfunction SystemJsNgModuleLoader_tsickle_Closure_declarations() {\n /** @type {?} */\nSystemJsNgModuleLoader.decorators;\n /**\n  * @nocollapse\n  * @type {?}\n  */\nSystemJsNgModuleLoader.ctorParameters;\n /** @type {?} */\nSystemJsNgModuleLoader.prototype._config;\n /** @type {?} */\nSystemJsNgModuleLoader.prototype._compiler;\n}\n\n/**\n * @param {?} value\n * @param {?} modulePath\n * @param {?} exportName\n * @return {?}\n */\nfunction checkNotEmpty(value: any, modulePath: string, exportName: string): any {\n  if (!value) {\n    throw new Error(`Cannot find '${exportName}' in '${modulePath}'`);\n  }\n  return value;\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}